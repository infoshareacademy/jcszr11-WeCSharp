@model CalendarParams
@{
    ViewData["Title"] = "Calendar";
}

<div class="text-center" style="height: calc(100vh - 140px);">
    <div class="container-fluid d-flex h-100 flex-column">
            <div class="row flex-nowrap monthName">
                <div class="buttonField"></div>
                <div class="buttonField">
                    <button type="button" class="btn btn-light" onclick="location.href='@Url.Action("PreviousMonth", "Calendar", Model.CurrentDate)'"><</button>
                </div>
                <div class="buttonField">
                    <button type="button" class="btn btn-light" onclick="location.href='@Url.Action("NextMonth", "Calendar", Model.CurrentDate)'">></button>
                </div>
                <div class="col">
                    @Model.FirstDayOfTheMonth.ToString("MMMM yyyy")
                </div>
                <div class="buttonField"></div>
                <div class="buttonField"></div>
                <div class="buttonField"></div>
            </div>
        <div class="row flex-nowrap" style="border-left: 1px solid lightgrey;">
            @for (int i = 0; i < 7; i++)
            {
                DateTime drawDayOfWeek = @Model.StartDate.AddDays(i);
                <div class="col calendarHeader">@drawDayOfWeek.DayOfWeek</div>
            }
        </div>
        <div class="row flex-nowrap flex-grow-1" style="border-left: 1px solid lightgrey;">
            @{
                int k = 0;
                DateTime drawDate = @Model.StartDate;
                while (true)
                {
                    if (drawDate >= Model.LastDayOfTheMonth && drawDate.DayOfWeek == DayOfWeek.Sunday)
                    {
                        break;
                    }
                    else
                    {
                        drawDate = @Model.StartDate.AddDays(k);
                        if (k % 7 == 0 && k > 0)
                        {
                            @:</div><div class="row flex-nowrap flex-grow-1" style="border-left: 1px solid lightgrey;">
                        }
                        if (drawDate.Month == @Model.CurrentDate.Month)
                        {
                            if (drawDate == DateTime.Today)
                            {
                                <button type="button" class="col calendarBlock thisMonth today" onclick="location.href='@Url.Action("Day", "Calendar", drawDate)'">@drawDate.Day</button>
                            }
                            else
                            {
                                <button type="button" class="col calendarBlock thisMonth" onclick="location.href='@Url.Action("Day", "Calendar", drawDate)'">@drawDate.Day</button>
                            }
                        }
                        else
                        {
                            <button type="button" class="col calendarBlock" onclick="location.href='@Url.Action("Day", "Calendar", drawDate)'">@drawDate.Day</button>
                        }
                        k += 1;
                    }
                }
            }
        </div>
    </div>
</div>
